<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Odhun Radio Player</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #0f0f0f; }
    .glass {
      backdrop-filter: blur(14px) saturate(180%);
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
  </style>
</head>
<body class="text-white p-4 select-none">

  <div class="max-w-xl mx-auto mt-6 glass p-6 shadow-2xl">
    <h1 class="text-3xl font-bold mb-4 text-center">Odhun Modern Radyo</h1>

    <!-- SEARCH -->
    <input id="search" type="text" placeholder="Radyo ara..." class="w-full p-3 rounded-xl bg-white/10 text-white focus:outline-none mb-4" />

    <!-- CATEGORY FILTER -->
    <select id="category" class="w-full p-3 rounded-xl bg-white/10 text-white focus:outline-none mb-4">
      <option value="all">Tümü</option>
      <option value="pop">Pop</option>
      <option value="slow">Slow</option>
      <option value="haber">Haber</option>
      <option value="yabanci">Yabancı</option>
    </select>

    <!-- RADIO LIST -->
    <div id="radioList" class="space-y-3 max-h-80 overflow-y-auto pr-2"></div>

    <!-- PLAYER AREA -->
    <div class="mt-6 glass p-5 text-center">
      <h2 id="nowPlaying" class="text-xl font-semibold mb-3">Seçim yap</h2>

      <button id="playBtn" class="px-6 py-3 bg-white/20 rounded-xl mb-4 w-full">▶ Oynat</button>

      <!-- VOLUME SLIDER -->
      <input id="volume" type="range" min="0" max="1" step="0.01" value="1" class="w-full" />

      <!-- VISUALIZER -->
      <canvas id="visualizer" class="w-full h-24 mt-4"></canvas>
    </div>
  </div>

<script>
const stations = [
  { name: "PowerTürk", url: "https://powerturk.com.tr/stream", cat: "pop" },
  { name: "SlowTürk", url: "https://slowturk.com.tr/stream", cat: "slow" },
  { name: "Kral Pop", url: "https://kralpop.com.tr/stream", cat: "pop" },
  { name: "CNN Türk Radyo", url: "https://cnnturk.com.tr/stream", cat: "haber" }
];

const list = document.getElementById("radioList");
stations.forEach(st => {
  const el = document.createElement("div");
  el.className = "glass p-3 cursor-pointer hover:bg-white/20";
  el.innerText = st.name;
  el.onclick = () => selectStation(st);
  list.appendChild(el);
});

let audio = new Audio();
let current = null;

function selectStation(st) {
  current = st;
  document.getElementById("nowPlaying").innerText = st.name;
  play();
}

function play() {
  if (!current) return;
  audio.src = current.url;
  audio.play();
  document.getElementById("playBtn").innerText = "⏸ Duraklat";
}

document.getElementById("playBtn").onclick = () => {
  if (!current) return;
  if (audio.paused) play(); else { audio.pause(); document.getElementById("playBtn").innerText = "▶ Oynat"; }
};

document.getElementById("volume").oninput = e => {
  audio.volume = e.target.value;
};

// SEARCH FILTER
const search = document.getElementById("search");
search.oninput = () => {
  const val = search.value.toLowerCase();
  [...list.children].forEach((item, i) => {
    item.style.display = stations[i].name.toLowerCase().includes(val) ? "block" : "none";
  });
};

// CATEGORY FILTER
const category = document.getElementById("category");
category.onchange = () => {
  const val = category.value;
  [...list.children].forEach((item, i) => {
    item.style.display = val === "all" || stations[i].cat === val ? "block" : "none";
  });
};

// VISUALIZER
const canvas = document.getElementById("visualizer");
const ctx = canvas.getContext("2d");
canvas.width = canvas.offsetWidth;
canvas.height = canvas.offsetHeight;
let audioCtx, analyser, src;

function setupVisualizer() {
  if (audioCtx) return;
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  analyser = audioCtx.createAnalyser();
  src = audioCtx.createMediaElementSource(audio);
  src.connect(analyser);
  analyser.connect(audioCtx.destination);

  visualize();
}

audio.onplay = () => setupVisualizer();

function visualize() {
  requestAnimationFrame(visualize);

  const data = new Uint8Array(analyser.frequencyBinCount);
  analyser.getByteFrequencyData(data);

  ctx.fillStyle = "black";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  const barWidth = canvas.width / 64;
  let x = 0;

  for (let i = 0; i < 64; i++) {
    const h = data[i] / 2;
    ctx.fillStyle = "white";
    ctx.fillRect(x, canvas.height - h, barWidth - 2, h);
    x += barWidth;
  }
}
</script>

</body>
</html>
